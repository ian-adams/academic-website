[build]
  command = "npm run build"
  publish = "dist"

[build.environment]
  NODE_VERSION = "20"

[functions]
  directory = "netlify/functions"
  node_bundler = "esbuild"

# API redirects for quiz endpoints
[[redirects]]
  from = "/api/quiz/fuckulator/submit"
  to = "/.netlify/functions/quiz-fuckulator-submit"
  status = 200

[[redirects]]
  from = "/api/quiz/fuckulator/stats"
  to = "/.netlify/functions/quiz-fuckulator-stats"
  status = 200

[[redirects]]
  from = "/api/quiz/judgment/submit"
  to = "/.netlify/functions/quiz-judgment-submit"
  status = 200

[[redirects]]
  from = "/api/quiz/judgment/stats"
  to = "/.netlify/functions/quiz-judgment-stats"
  status = 200

[[redirects]]
  from = "/api/quiz/cascade/submit"
  to = "/.netlify/functions/quiz-cascade-submit"
  status = 200

[[redirects]]
  from = "/api/quiz/cascade/stats"
  to = "/.netlify/functions/quiz-cascade-stats"
  status = 200

# Headers for static assets
[[headers]]
  for = "/data/*"
  [headers.values]
    Cache-Control = "public, max-age=300, stale-while-revalidate=3600"

[[headers]]
  for = "/_assets/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/media/cv.pdf"
  [headers.values]
    Cache-Control = "public, max-age=300, stale-while-revalidate=3600"

[[headers]]
  for = "/media/*"
  [headers.values]
    Cache-Control = "public, max-age=604800"

[[headers]]
  for = "/pdfs/*"
  [headers.values]
    Cache-Control = "public, max-age=604800"
